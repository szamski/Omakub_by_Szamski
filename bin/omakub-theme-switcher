#!/bin/bash

set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
if [[ -d "$SCRIPT_DIR/../install" ]]; then
  OMAKUB_SZAMSKI_PATH="$(cd "$SCRIPT_DIR/.." && pwd)"
else
  OMAKUB_SZAMSKI_PATH="${OMAKUB_SZAMSKI_PATH:-$HOME/.local/share/omakub-szamski}"
fi

APP_DIR="$OMAKUB_SZAMSKI_PATH/apps/theme-switcher"
BIN="$APP_DIR/target/release/omakub-theme-switcher"

if [[ ! -x "$BIN" ]]; then
  echo "Theme switcher binary not found: $BIN"
  exit 1
fi

OMAKUB_SZAMSKI_PATH="$OMAKUB_SZAMSKI_PATH" "$BIN"
